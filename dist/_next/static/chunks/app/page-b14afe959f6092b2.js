(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3792:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(5155),o=r(2115),s=r(5695),n=r(5077);function c(){let e=(0,s.useRouter)();return(0,o.useEffect)(()=>{(async()=>{let t=localStorage.getItem("accessToken");if(!t)return e.replace("/auth");try{let r=await n.A.get("/auth/me",{headers:{Authorization:"Bearer ".concat(t)}});200===r.status?e.replace("/dashboard"):e.replace("/auth")}catch(t){e.replace("/auth")}})()},[e]),(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-blue-900 to-blue-700",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-400 mb-6"}),(0,a.jsx)("div",{className:"text-white text-lg font-semibold",children:"Chargement..."})]})}},5077:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var a=r(3464);let o="https://api.blaffa.net",s=a.A.create({baseURL:o,headers:{"Content-Type":"application/json"}}),n=!1,c=[],l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;c.forEach(r=>{e?r.reject(e):r.resolve(t)}),c=[]};s.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!r._retry){if(n)return new Promise((e,t)=>{c.push({resolve:e,reject:t})}).then(e=>(r.headers.Authorization="Bearer ".concat(e),s(r))).catch(e=>Promise.reject(e));r._retry=!0,n=!0;try{let t=localStorage.getItem("refreshToken");if(!t)return localStorage.removeItem("accessToken"),window.location.href="/auth",Promise.reject(e);let{access:n,refresh:c}=(await a.A.post("".concat(o,"/auth/refresh"),{refresh:t},{headers:{"Content-Type":"application/json"}})).data;return localStorage.setItem("accessToken",n),c&&localStorage.setItem("refreshToken",c),s.defaults.headers.common.Authorization="Bearer ".concat(n),r.headers.Authorization="Bearer ".concat(n),l(null,n),s(r)}catch(e){return console.error("Failed to refresh token:",e),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/auth",l(e),Promise.reject(e)}finally{n=!1}}return Promise.reject(e)});let u=s},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},6530:(e,t,r)=>{Promise.resolve().then(r.bind(r,3792))}},e=>{var t=t=>e(e.s=t);e.O(0,[464,441,684,358],()=>t(6530)),_N_E=e.O()}]);