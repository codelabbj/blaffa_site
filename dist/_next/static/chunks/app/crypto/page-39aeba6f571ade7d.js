(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[286],{539:(e,t,r)=>{"use strict";r.d(t,{f:()=>n,h:()=>o});var l=r(5155),a=r(2115);let s=(0,a.createContext)(void 0),n=e=>{let{children:t}=e,r=(0,a.useRef)(null),n=(0,a.useRef)([]),o=(0,a.useRef)(0),c=(0,a.useRef)(!1),i=(0,a.useRef)(null),d=()=>{let e=localStorage.getItem("accessToken");if(!e)return void console.log("No access token found, skipping WebSocket connection");r.current&&r.current.close();try{let t="wss://api.blaffa.net/ws/socket?token=".concat(encodeURIComponent(e));r.current=new WebSocket(t),r.current.onopen=()=>{console.log("WebSocket connected"),c.current=!0,o.current=0},r.current.onmessage=e=>{try{let t=JSON.parse(e.data);console.log("WebSocket message received:",t),n.current.forEach(e=>e(t))}catch(e){console.error("Error processing WebSocket message:",e)}},r.current.onclose=()=>{c.current=!1,console.log("WebSocket disconnected, attempting to reconnect...");let e=Math.min(1e3*Math.pow(2,o.current),3e4);o.current++,i.current=setTimeout(d,e)},r.current.onerror=e=>{console.error("WebSocket error:",e)}}catch(e){console.error("WebSocket connection error:",e)}};return(0,a.useEffect)(()=>(d(),()=>{r.current&&r.current.close(),i.current&&clearTimeout(i.current)}),[]),(0,l.jsx)(s.Provider,{value:{addMessageHandler:e=>(n.current.push(e),()=>{n.current=n.current.filter(t=>t!==e)}),sendMessage:e=>{var t;(null==(t=r.current)?void 0:t.readyState)===WebSocket.OPEN?r.current.send(JSON.stringify(e)):console.error("WebSocket is not connected")},isConnected:c.current},children:t})},o=()=>{let e=(0,a.useContext)(s);if(void 0===e)throw Error("useWebSocket must be used within a WebSocketProvider");return e}},3966:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var l=r(5155),a=r(2115),s=r(5077),n=r(7280),o=r(1218),c=r(9911),i=r(539);let d="https://api.blaffa.net/blaffa/transaction";function u(e){let{isVerified:t,crypto:r,typeTrans:u}=e,{t:b}=(0,o.Bd)(),{theme:x}=(0,n.D)(),{addMessageHandler:g}=(0,i.h)(),[h,f]=(0,a.useState)(""),[p,v]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),[w,N]=(0,a.useState)(""),[k,S]=(0,a.useState)(""),[C,_]=(0,a.useState)(""),[P,O]=(0,a.useState)(null),[T,E]=(0,a.useState)(!1),[A,I]=(0,a.useState)(null),[z,B]=(0,a.useState)(""),[R,U]=(0,a.useState)([]),[F,W]=(0,a.useState)(null),[D,L]=(0,a.useState)(null),[M,V]=(0,a.useState)(""),[J,Y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{(async()=>{let e=localStorage.getItem("accessToken");if(e)try{let t=await s.A.get("/blaffa/network/",{headers:{Authorization:"Bearer ".concat(e)}});Array.isArray(t.data)&&U(t.data)}catch(e){}})()},[]),(0,a.useEffect)(()=>{if(!h||isNaN(Number(h))||!u)return void v("");"buy"===u?v((Number(h)/Number(r.public_amount)).toFixed(2)):"sale"===u&&v((Number(h)*Number(r.public_amount)).toFixed(2))},[h,r,u]),(0,a.useEffect)(()=>{let e=g(e=>{"transaction_link"===e.type&&e.data&&L(e.data)});return()=>e()},[g]);let q=async()=>{if(B(""),I(null),!F)return void B(b("Please select a network."));if("sale"===u)return void Y(!0);E(!0);try{let e={type_trans:"buy",total_crypto:p,crypto_id:String(r.id),phone_number:y.replace(/\s+/g,""),network_id:F.id,amount:h,wallet_link:k},t=localStorage.getItem("accessToken"),l={"Content-Type":"application/json",...t?{Authorization:"Bearer ".concat(t)}:{}},a=await fetch(d,{method:"POST",headers:l,body:JSON.stringify(e)}),s=await a.json();I(s),s&&s.transaction_link&&window.open(s.transaction_link,"_blank","noopener,noreferrer")}catch(e){B(b("Transaction failed. Please try again."))}finally{E(!1),O(null)}},X=e=>{navigator.clipboard.writeText(e)},H=async()=>{if(E(!0),B(""),I(null),!F){B(b("Please select a network.")),E(!1);return}try{let e={type_trans:"sale",total_crypto:h,crypto_id:String(r.id),phone_number:y.replace(/\s+/g,""),network_id:F.id,amount:p,hash:M},t=localStorage.getItem("accessToken"),l={"Content-Type":"application/json",...t?{Authorization:"Bearer ".concat(t)}:{}},a=await fetch(d,{method:"POST",headers:l,body:JSON.stringify(e)}),s=await a.json();I(s),s&&s.transaction_link&&window.open(s.transaction_link,"_blank","noopener,noreferrer"),setTimeout(()=>{Y(!1),I(null),V(""),O(null)},2e3)}catch(e){B(b("Transaction failed. Please try again."))}finally{E(!1)}};return t?(0,l.jsxs)("div",{className:"bg-gradient-to-r rounded-2xl shadow-2xl p-6 sm:p-8 w-full max-w-xs sm:max-w-md relative mx-auto mt-8",style:{background:"dark"===x.mode?"linear-gradient(135deg, rgba(30,41,59,0.85) 60%, rgba(51,65,85,0.85) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.85) 60%, rgba(226,232,240,0.85) 100%)",borderColor:"dark"===x.mode?"#334155":"#e5e7eb"},children:[(0,l.jsx)("h2",{className:"text-2xl font-extrabold mb-6 text-center",style:{color:x.colors.primary},children:"buy"===u?"".concat(b("Buy")," ").concat(r.name):"sale"===u?"".concat(b("Sell")," ").concat(r.name):"".concat(b("Buy or Sell")," ").concat(r.name)}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:b("Select Network")}),(0,l.jsxs)("select",{className:"w-full p-3 rounded-lg border focus:ring-2 focus:ring-blue-400 text-lg transition-colors\n            ".concat("dark"===x.mode?"bg-slate-900 border-slate-600 text-slate-100":"bg-white border-slate-300 text-slate-900"),value:(null==F?void 0:F.id)||"",onChange:e=>{W(R.find(t=>String(t.id)===e.target.value)||null)},children:[(0,l.jsx)("option",{value:"",children:b("Select a network")}),R.map(e=>(0,l.jsx)("option",{value:String(e.id),children:e.public_name||e.name},e.id))]}),F&&F.image&&(0,l.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,l.jsx)("img",{src:F.image,alt:F.name,className:"w-8 h-8 rounded"}),(0,l.jsx)("span",{className:"text-sm",children:F.public_name||F.name})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-4 mb-6 justify-center",children:[r.logo&&(0,l.jsx)("img",{src:r.logo,alt:r.name,className:"w-14 h-14 rounded-full border-2 border-blue-400 shadow-md"}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"font-bold text-lg flex items-center gap-2",children:[r.name,(0,l.jsx)("span",{className:"inline-block bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-200 px-2 py-0.5 rounded-full text-xs font-semibold border border-blue-300 ml-1",children:r.symbol})]}),(0,l.jsxs)("div",{className:"text-blue-500 text-sm font-mono",children:[b("Public Amount"),": ",r.public_amount," XOF"]})]})]}),(0,l.jsxs)("div",{className:"mb-4 relative",children:[(0,l.jsx)("label",{className:"block mb-1 font-medium",children:"buy"===u?b("Amount (Local Currency)"):b("Amount (Crypto)")}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-400",children:(0,l.jsx)(c.MxO,{})}),(0,l.jsx)("input",{type:"number",className:"w-full p-3 pl-10 rounded-lg border focus:ring-2 focus:ring-blue-400 text-lg transition-colors\n              ".concat("dark"===x.mode?"bg-slate-900 border-slate-600 text-slate-100 placeholder-slate-400":"bg-white border-slate-300 text-slate-900 placeholder-slate-400"),value:h,onChange:e=>f(e.target.value),min:"0",placeholder:"buy"===u?b("Enter amount"):b("Enter crypto amount")})]})]}),p&&(0,l.jsx)("div",{className:"mb-4 ".concat("buy"===u?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"," text-center text-lg font-semibold"),children:"buy"===u?(0,l.jsxs)(l.Fragment,{children:[b("You will get"),": ",(0,l.jsxs)("span",{className:"font-bold",children:[p," ",r.symbol]})]}):(0,l.jsxs)(l.Fragment,{children:[b("You will receive"),": ",(0,l.jsxs)("span",{className:"font-bold",children:[p," XOF"]})]})}),"buy"===u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-4 relative",children:[(0,l.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-400",children:(0,l.jsx)(c.lcY,{})}),(0,l.jsx)("input",{type:"text",className:"w-full p-3 pl-10 rounded-lg border focus:ring-2 focus:ring-blue-400 transition-colors\n                ".concat("dark"===x.mode?"bg-slate-900 border-slate-600 text-slate-100 placeholder-slate-400":"bg-white border-slate-300 text-slate-900 placeholder-slate-400"),placeholder:b("Wallet link"),value:k,onChange:e=>S(e.target.value)})]}),(0,l.jsxs)("div",{className:"mb-4 relative",children:[(0,l.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-400",children:(0,l.jsx)(c.lcY,{})}),(0,l.jsx)("input",{type:"text",className:"w-full p-3 pl-10 rounded-lg border focus:ring-2 focus:ring-blue-400 transition-colors\n                ".concat("dark"===x.mode?"bg-slate-900 border-slate-600 text-slate-100 placeholder-slate-400":"bg-white border-slate-300 text-slate-900 placeholder-slate-400"),placeholder:b("Confirm wallet link"),value:C,onChange:e=>_(e.target.value)})]})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-4 relative",children:[(0,l.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-400",children:(0,l.jsx)(c.dRU,{})}),(0,l.jsx)("input",{type:"tel",className:"w-full p-3 pl-10 rounded-lg border focus:ring-2 focus:ring-blue-400 transition-colors\n                ".concat("dark"===x.mode?"bg-slate-900 border-slate-600 text-slate-100 placeholder-slate-400":"bg-white border-slate-300 text-slate-900 placeholder-slate-400"),placeholder:b("Phone number"),value:y,onChange:e=>j(e.target.value)})]}),(0,l.jsxs)("div",{className:"mb-4 relative",children:[(0,l.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-400",children:(0,l.jsx)(c.dRU,{})}),(0,l.jsx)("input",{type:"tel",className:"w-full p-3 pl-10 rounded-lg border focus:ring-2 focus:ring-blue-400 transition-colors\n                ".concat("dark"===x.mode?"bg-slate-900 border-slate-600 text-slate-100 placeholder-slate-400":"bg-white border-slate-300 text-slate-900 placeholder-slate-400"),placeholder:b("Confirm phone number"),value:w,onChange:e=>N(e.target.value)})]})]}),z&&(0,l.jsx)("div",{className:"mb-4 text-red-500 text-center font-medium",children:b(z)}),(0,l.jsxs)("button",{className:"w-full py-3 rounded-lg font-bold text-lg flex items-center justify-center gap-2 transition bg-gradient-to-r from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white shadow-lg active:scale-95",onClick:()=>{if(!h)return void B(b("Please fill all fields."));if(!F)return void B(b("Please select a network."));if("buy"===u){if(!k||!C||k!==C)return void B(b("Please fill all fields and confirm your wallet link."));B(""),O("wallet")}else{let e=y.replace(/\s+/g,""),t=w.replace(/\s+/g,"");if(!e||e!==t)return void B(b("Please fill all fields and confirm your phone number."));B(""),O("confirm")}},disabled:T,children:[(0,l.jsx)(c.A7C,{})," ",b("Continue")]}),"wallet"===P&&"buy"===u&&(0,l.jsx)(m,{onClose:()=>O(null),theme:x,children:(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-bold mb-2 text-center",children:b("Enter your phone number")}),(0,l.jsxs)("div",{className:"relative mb-2",children:[(0,l.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-400",children:(0,l.jsx)(c.dRU,{})}),(0,l.jsx)("input",{type:"tel",className:"w-full p-3 pl-10 rounded-lg border focus:ring-2 focus:ring-blue-400 transition-colors\n                  ".concat("dark"===x.mode?"bg-slate-900 border-slate-600 text-slate-100 placeholder-slate-400":"bg-white border-slate-300 text-slate-900 placeholder-slate-400"),placeholder:b("Phone number"),value:y,onChange:e=>j(e.target.value)})]}),(0,l.jsxs)("div",{className:"relative mb-2",children:[(0,l.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-400",children:(0,l.jsx)(c.dRU,{})}),(0,l.jsx)("input",{type:"tel",className:"w-full p-3 pl-10 rounded-lg border focus:ring-2 focus:ring-blue-400 transition-colors\n                  ".concat("dark"===x.mode?"bg-slate-900 border-slate-600 text-slate-100 placeholder-slate-400":"bg-white border-slate-300 text-slate-900 placeholder-slate-400"),placeholder:b("Confirm phone number"),value:w,onChange:e=>N(e.target.value)})]}),z&&(0,l.jsx)("div",{className:"mb-2 text-red-500 text-center",children:b(z)}),(0,l.jsxs)("button",{className:"w-full bg-gradient-to-r from-blue-500 to-blue-700 text-white py-2 rounded-lg font-bold text-lg shadow-md hover:from-blue-600 hover:to-blue-800 transition mt-2 flex items-center justify-center gap-2",onClick:()=>{if(!k||k!==C)return void B(b("Wallet links do not match."));let e=y.replace(/\s+/g,""),t=w.replace(/\s+/g,"");if(!e||e!==t)return void B(b("Please fill all fields and confirm your phone number."));B(""),O("confirm")},children:[(0,l.jsx)(c.A7C,{})," ",b("Continue")]})]})}),"confirm"===P&&(0,l.jsx)(m,{onClose:()=>O(null),theme:x,children:(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-bold mb-2 text-center",children:b("Confirm your transaction")}),(0,l.jsxs)("div",{className:"mb-2",children:["Type: ",(0,l.jsx)("span",{className:"font-semibold",children:null==u?void 0:u.toUpperCase()})]}),(0,l.jsxs)("div",{className:"mb-2",children:["Crypto: ",(0,l.jsx)("span",{className:"font-semibold",children:r.name})]}),(0,l.jsxs)("div",{className:"mb-2",children:["Amount: ",(0,l.jsx)("span",{className:"font-semibold",children:"sale"===u?"".concat(p," XOF"):"".concat(p," ").concat(r.symbol)})]}),(0,l.jsxs)("div",{className:"mb-2",children:["Phone: ",(0,l.jsx)("span",{className:"font-semibold",children:y})]}),(0,l.jsxs)("div",{className:"mb-2",children:["Network: ",(0,l.jsx)("span",{className:"font-semibold",children:(null==F?void 0:F.public_name)||(null==F?void 0:F.name)})]}),"buy"===u&&(0,l.jsxs)("div",{className:"mb-2",children:["Wallet Link: ",(0,l.jsx)("span",{className:"font-semibold break-all",children:k})]}),(0,l.jsxs)("button",{className:"w-full bg-gradient-to-r from-green-500 to-green-700 text-white py-2 rounded-lg font-bold text-lg shadow-md hover:from-green-600 hover:to-green-800 transition mt-4 flex items-center justify-center gap-2",onClick:q,disabled:T,children:[T?b("Processing..."):(0,l.jsx)(c.A7C,{})," ",b("Confirm")]})]})}),A&&(0,l.jsxs)("div",{className:"mt-6 p-4 rounded-lg text-center shadow-lg",style:{background:"dark"===x.mode?"linear-gradient(135deg, rgba(30,41,59,0.95) 60%, rgba(51,65,85,0.95) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.95) 60%, rgba(226,232,240,0.95) 100%)"},children:["sale"===u&&(null==A?void 0:A.wallet_address)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"mb-2 font-bold",children:[b("Sell Wallet Address"),":"]}),(0,l.jsx)("div",{className:"mb-2 break-all text-blue-600 dark:text-blue-300 font-mono text-lg",children:A.wallet_address}),(0,l.jsx)("button",{className:"bg-gradient-to-r from-blue-500 to-blue-700 text-white px-3 py-1 rounded-lg font-semibold mt-2",onClick:()=>X(A.wallet_address),children:b("Copy")}),(0,l.jsx)("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-300",children:b("Send your crypto to this address to complete the sale.")})]}),"buy"===u&&(0,l.jsxs)("div",{className:"text-green-600 dark:text-green-400 font-bold flex flex-col items-center gap-2",children:[(0,l.jsx)(c.A7C,{className:"text-2xl"}),b("Your buy request has been submitted!")]})]}),D&&(0,l.jsx)(m,{onClose:()=>L(null),theme:x,children:(0,l.jsxs)("div",{className:"p-6 flex flex-col items-center",children:[(0,l.jsx)("h3",{className:"text-lg font-bold mb-4 text-center",children:b("Continue Payment")}),(0,l.jsx)("button",{onClick:()=>window.open(D,"_blank","noopener,noreferrer"),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors font-bold text-lg shadow-md",children:b("Click to continue payment")})]})}),J&&"sale"===u&&(0,l.jsx)(m,{onClose:()=>Y(!1),theme:x,children:(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("h3",{className:"text-lg font-bold mb-2 text-center",children:b("Adresse de vente")}),(0,l.jsxs)("div",{className:"mb-2 relative flex items-center",children:[(0,l.jsx)("input",{type:"text",className:"w-full p-3 rounded-lg border focus:ring-2 focus:ring-blue-400 transition-colors font-mono",value:r.sale_adress||"",readOnly:!0}),(0,l.jsx)("button",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-blue-500 hover:text-blue-700",onClick:()=>X(r.sale_adress||""),title:b("Copier"),children:(0,l.jsx)(c.paH,{})})]}),(0,l.jsx)("div",{className:"text-sm text-gray-500 mb-4",children:"Copiez l'adresse de vente pour vendre votre crypto."}),(0,l.jsx)("div",{className:"mb-4 relative",children:(0,l.jsx)("input",{type:"text",className:"w-full p-3 rounded-lg border focus:ring-2 focus:ring-blue-400 transition-colors",placeholder:b("Entrez le hash de la transaction"),value:M,onChange:e=>V(e.target.value)})}),z&&(0,l.jsx)("div",{className:"mb-2 text-red-500 text-center font-medium",children:b(z)}),A&&(0,l.jsx)("div",{className:"mb-2 text-green-600 text-center font-medium",children:b("Votre vente a \xe9t\xe9 soumise avec succ\xe8s!")}),(0,l.jsxs)("button",{className:"w-full bg-gradient-to-r from-green-500 to-green-700 text-white py-2 rounded-lg font-bold text-lg shadow-md hover:from-green-600 hover:to-green-800 transition mt-2 flex items-center justify-center gap-2",onClick:H,disabled:T||!M,children:[T?b("Traitement..."):(0,l.jsx)(c.A7C,{})," ",b("OK")]})]})})]}):(0,l.jsx)("div",{className:"p-4 bg-yellow-100 text-yellow-800 rounded-lg text-center",children:b("Please verify your account to buy or sell crypto.")})}function m(e){let{children:t,onClose:r,theme:a}=e;return(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backdropFilter:"blur(6px)"},children:(0,l.jsxs)("div",{className:"rounded-xl shadow-2xl max-w-md w-full relative border",style:{background:"dark"===a.mode?"linear-gradient(135deg, rgba(30,41,59,0.97) 60%, rgba(51,65,85,0.97) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.97) 60%, rgba(226,232,240,0.97) 100%)",borderColor:"dark"===a.mode?"#334155":"#e5e7eb"},children:[(0,l.jsx)("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 text-2xl font-bold",onClick:r,children:"\xd7"}),t]})})}var b=r(4894);function x(){let{t:e,i18n:t}=(0,o.Bd)(),{theme:r}=(0,n.D)(),[i,d]=(0,a.useState)([]),[m,x]=(0,a.useState)(!0),[g,h]=(0,a.useState)(null),[f,p]=(0,a.useState)(!1),[v,y]=(0,a.useState)(null),[j,w]=(0,a.useState)(""),[N,k]=(0,a.useState)(!1),[S,C]=(0,a.useState)(null),[_,P]=(0,a.useState)(null),[O,T]=(0,a.useState)(null),[E,A]=(0,a.useState)(!1),[I,z]=(0,a.useState)(!1),[B,R]=(0,a.useState)(""),[U,F]=(0,a.useState)(null),[W,D]=(0,a.useState)(!0),[L,M]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{if(L){x(!0),h(null);try{let e=localStorage.getItem("accessToken"),t=await s.A.get("https://api.blaffa.net/blaffa/crypto"+"?type_trans=".concat(L),{headers:{"Content-Type":"application/json",...e?{Authorization:"Bearer ".concat(e)}:{}}});d(Array.isArray(t.data.results)?t.data.results:[])}catch(t){h(e("Failed to fetch cryptocurrencies"))}finally{x(!1)}}})();let r=localStorage.getItem("userId");if(r)w(r);else{let e=localStorage.getItem("accessToken");e&&s.A.get("/auth/me",{headers:{Authorization:"Bearer ".concat(e)}}).then(e=>{let t=e.data;t&&t.id&&(localStorage.setItem("userId",t.id.toString()),w(t.id.toString()))}).catch(()=>{})}t.changeLanguage("fr"),console.log("Current language:",t.language,"Back:",e("Back"))},[t.language,L]),(0,a.useEffect)(()=>{if(!j)return;let e=!0;return(async()=>{A(!0);try{var t,r;let l=localStorage.getItem("accessToken"),a=await fetch("https://api.blaffa.net/auth/check-user-account-status",{method:"POST",headers:{"Content-Type":"application/json",...l?{Authorization:"Bearer ".concat(l)}:{}},body:JSON.stringify({user_id:j})}),s=await a.json(),n=null!=(r=null!=(t=s.is_verified)?t:s.is_verify)&&r;e&&y(!!n)}catch(t){e&&y(!1)}finally{e&&A(!1)}})(),()=>{e=!1}},[j]);let V=t=>{if(!j)return void h(e("User ID not found. Please log in."));v?F(t):p(!0)},J=async t=>{if(t.preventDefault(),k(!0),C(null),!_||!O){C(e("Please select both images.")),k(!1);return}try{let t=new FormData;for(let e of(t.append("file",_),t.append("image",O),console.log("FormData contents:"),t.entries()))console.log(e[0]+":",e[1]);let r=localStorage.getItem("accessToken"),l=await fetch("https://api.blaffa.net/blaffa/upload/file",{method:"POST",headers:{...r?{Authorization:"Bearer ".concat(r)}:{}},body:t});if(console.log("Response status:",l.status),console.log("Response headers:",Object.fromEntries(l.headers.entries())),!l.ok){let e=await l.text();throw console.error("Error response body:",e),Error("Upload failed: ".concat(l.status," ").concat(l.statusText))}let a=await l.json();console.log("Upload response:",a),p(!1),R(e("Images uploaded. Please wait for admin verification.")),z(!0),y(!1)}catch(t){console.error("Upload error:",t),C(e("Failed to upload images. Try again."))}finally{k(!1)}};return(0,l.jsxs)("div",{className:"min-h-screen bg-gradient-to-br ".concat(r.colors.a_background," p-2 sm:p-4 flex flex-col items-center"),children:[W&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-2 sm:px-0",children:(0,l.jsxs)("div",{className:"bg-gradient-to-r ".concat(r.colors.a_background," rounded-2xl shadow-2xl p-6 sm:p-8 w-full max-w-xs sm:max-w-md relative flex flex-col items-center"),children:[(0,l.jsx)("h2",{className:"text-lg sm:text-xl font-bold mb-4 text-center",children:e("Choose Transaction Type")}),(0,l.jsxs)("div",{className:"flex flex-col gap-4 w-full",children:[(0,l.jsx)("button",{className:"w-full px-6 py-3 bg-green-600 text-white rounded-lg text-lg font-semibold hover:bg-green-700 transition-all",onClick:()=>{M("buy"),D(!1)},children:e("Buy Crypto")}),(0,l.jsx)("button",{className:"w-full px-6 py-3 bg-yellow-500 text-white rounded-lg text-lg font-semibold hover:bg-yellow-600 transition-all",onClick:()=>{M("sale"),D(!1)},children:e("Sell Crypto")})]})]})}),(0,l.jsx)("button",{onClick:()=>window.history.back(),className:"fixed top-3 left-3 z-50 w-10 h-10 flex items-center justify-center rounded-full shadow-md\n           bg-transparent text-blue-600 dark:text-blue-200  transition-all","aria-label":e("Back to Crypto"),style:{backdropFilter:"blur(4px)"},children:(0,l.jsx)(c.QVr,{className:"text-xl"})}),(0,l.jsxs)("div",{className:"w-full max-w-screen-sm",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-6 sm:mb-8",children:[(0,l.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-center sm:text-left w-full sm:w-auto",children:e("Cryptocurrencies")}),(0,l.jsx)("div",{className:"flex justify-center sm:justify-end w-full sm:w-auto relative",children:(()=>{let t="rounded-full flex items-center justify-center shadow-md transition-all",r="w-9 h-9 text-xl",a="fixed top-3 right-3 z-50 sm:static sm:top-auto sm:right-auto";return E?(0,l.jsx)("span",{className:"".concat(t," ").concat(r," ").concat(a," bg-gray-300 animate-spin text-blue-500"),title:e("Checking..."),children:(0,l.jsx)(b.kiM,{})}):!0===v?(0,l.jsx)("span",{className:"".concat(t," ").concat(r," ").concat(a," bg-green-500 text-white"),title:e("Verified"),children:(0,l.jsx)(c.A7C,{})}):(0,l.jsx)("span",{className:"".concat(t," ").concat(r," ").concat(a," bg-yellow-400 text-white"),title:e("Not Verified"),children:(0,l.jsx)(c.BS8,{})})})()})]}),g&&(0,l.jsx)("div",{className:"mb-4 p-3 sm:p-4 bg-red-100 border border-red-400 text-red-700 rounded text-sm sm:text-base",children:g}),L&&!W&&(U?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{className:"mb-4 flex items-center gap-2 rounded-lg shadow-sm font-semibold transition-all\n                px-2 py-1 sm:px-4 sm:py-2\n                text-base sm:text-lg\n                ".concat("dark"===r.mode?"bg-slate-800 text-blue-300 hover:bg-slate-700":"bg-blue-50 text-blue-700 hover:bg-blue-100","\n                "),style:{border:"1px solid ".concat(r.colors.accent)},onClick:()=>F(null),children:[(0,l.jsx)(c.QVr,{className:"text-lg sm:mr-2"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:e("Back to Cryptos")})]}),("buy"===L||"sale"===L)&&(0,l.jsx)(u,{isVerified:!0===v,crypto:U,typeTrans:L})]}):m?(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[200px] sm:min-h-[300px]",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-4 border-blue-500/30 border-t-blue-500"})}):(0,l.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6",children:i.map(e=>(0,l.jsxs)("div",{className:"group relative overflow-hidden bg-gradient-to-br ".concat(r.colors.s_background," border border-slate-600/30 rounded-2xl p-4 sm:p-6 flex flex-col items-center shadow-md hover:scale-[1.03] active:scale-95 transition-all duration-200 cursor-pointer"),onClick:()=>V(e),children:[(0,l.jsx)("img",{src:e.logo,alt:e.name,className:"w-10 h-10 sm:w-12 sm:h-12 object-contain mb-3 sm:mb-4 rounded-full border border-slate-300 bg-white"}),(0,l.jsx)("div",{className:"font-bold text-base sm:text-lg mb-1 sm:mb-2 text-center",children:e.name}),(0,l.jsx)("div",{className:"text-slate-400 text-xs sm:text-sm mb-1",children:e.symbol}),(0,l.jsxs)("div",{className:"text-blue-500 font-mono text-2xl sm:text-3xl font-extrabold",children:[e.public_amount,"xof"]})]},e.id))})),f&&!v&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-2 sm:px-0",children:(0,l.jsxs)("div",{className:"bg-gradient-to-r ".concat(r.colors.a_background," rounded-2xl shadow-2xl p-4 sm:p-8 w-full max-w-xs sm:max-w-md relative"),children:[(0,l.jsx)("h2",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4 text-center",children:e("Account Verification Required")}),(0,l.jsxs)("form",{onSubmit:J,children:[(0,l.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 sm:mb-2 text-sm sm:text-base font-semibold",children:e("Upload your image (face)")}),(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return P((null==(t=e.target.files)?void 0:t[0])||null)},className:"w-full text-xs sm:text-sm border rounded p-2"}),_&&(0,l.jsx)("div",{className:"mt-2 flex justify-center",children:(0,l.jsx)("img",{src:URL.createObjectURL(_),alt:"Preview",className:"h-20 w-20 object-cover rounded shadow"})})]}),(0,l.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,l.jsx)("label",{className:"block mb-1 sm:mb-2 text-sm sm:text-base font-semibold",children:e("Upload your card image (ID card)")}),(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return T((null==(t=e.target.files)?void 0:t[0])||null)},className:"w-full text-xs sm:text-sm border rounded p-2"}),O&&(0,l.jsx)("div",{className:"mt-2 flex justify-center",children:(0,l.jsx)("img",{src:URL.createObjectURL(O),alt:"Preview",className:"h-20 w-20 object-cover rounded shadow"})})]}),S&&(0,l.jsx)("div",{className:"mb-2 text-red-600 text-xs sm:text-sm text-center",children:S}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 mt-4",children:[(0,l.jsx)("button",{type:"button",className:"w-full sm:flex-1 px-4 py-2 bg-gray-400 dark:bg-slate-700 rounded hover:bg-gray-300 dark:hover:bg-slate-600 text-sm sm:text-base",onClick:()=>p(!1),disabled:N,children:e("Cancel")}),(0,l.jsx)("button",{type:"submit",className:"w-full sm:flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm sm:text-base",disabled:N,children:N?e("Uploading..."):e("Upload & Submit")})]})]})]})}),I&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-2 sm:px-0",children:(0,l.jsxs)("div",{className:"bg-gradient-to-r ".concat(r.colors.a_background," rounded-2xl shadow-2xl p-6 sm:p-8 w-full max-w-xs sm:max-w-md relative"),children:[(0,l.jsx)("h2",{className:"text-lg sm:text-xl font-bold mb-4 text-center text-green-600",children:e("Success")}),(0,l.jsx)("div",{className:"mb-6 text-center text-base sm:text-lg",children:B}),(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)("button",{className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-base",onClick:()=>z(!1),children:e("Close")})})]})})]})]})}},4436:(e,t,r)=>{"use strict";r.d(t,{k5:()=>d});var l=r(2115),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s=l.createContext&&l.createContext(a),n=["attr","size","title"];function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(e[l]=r[l])}return e}).apply(this,arguments)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,l)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach(function(t){var l,a,s;l=e,a=t,s=r[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var l=r.call(e,t||"default");if("object"!=typeof l)return l;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in l?Object.defineProperty(l,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):l[a]=s}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>l.createElement(u,o({attr:i({},e.attr)},t),function e(t){return t&&t.map((t,r)=>l.createElement(t.tag,i({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:a,size:s,title:c}=e,d=function(e,t){if(null==e)return{};var r,l,a=function(e,t){if(null==e)return{};var r={};for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){if(t.indexOf(l)>=0)continue;r[l]=e[l]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(l=0;l<s.length;l++)r=s[l],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,n),u=s||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),l.createElement("svg",o({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,d,{className:r,style:i(i({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),c&&l.createElement("title",null,c),e.children)};return void 0!==s?l.createElement(s.Consumer,null,e=>t(e)):t(a)}},5077:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var l=r(3464);let a="https://api.blaffa.net",s=l.A.create({baseURL:a,headers:{"Content-Type":"application/json"}}),n=!1,o=[],c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;o.forEach(r=>{e?r.reject(e):r.resolve(t)}),o=[]};s.interceptors.request.use(e=>{let t=localStorage.getItem("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!r._retry){if(n)return new Promise((e,t)=>{o.push({resolve:e,reject:t})}).then(e=>(r.headers.Authorization="Bearer ".concat(e),s(r))).catch(e=>Promise.reject(e));r._retry=!0,n=!0;try{let t=localStorage.getItem("refreshToken");if(!t)return localStorage.removeItem("accessToken"),window.location.href="/auth",Promise.reject(e);let{access:n,refresh:o}=(await l.A.post("".concat(a,"/auth/refresh"),{refresh:t},{headers:{"Content-Type":"application/json"}})).data;return localStorage.setItem("accessToken",n),o&&localStorage.setItem("refreshToken",o),s.defaults.headers.common.Authorization="Bearer ".concat(n),r.headers.Authorization="Bearer ".concat(n),c(null,n),s(r)}catch(e){return console.error("Failed to refresh token:",e),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/auth",c(e),Promise.reject(e)}finally{n=!1}}return Promise.reject(e)});let i=s},7280:(e,t,r)=>{"use strict";r.d(t,{D:()=>c,N:()=>o});var l=r(5155),a=r(2115);let s={light:{mode:"light",colors:{primary:"#0070f3",secondary:"#0ea5e9",s_text:"text-blue-600",d_text:"text-slate-900",s_background:"from-slate-100/80 to-slate-200/80",sl_background:"bg-slate-100",c_background:"bg-slate-100/50",a_background:"from-slate-100 via-blue-100 to-slate-50",background:"bg-slate-50",text:"#1f2937",accent:"#8b5cf6",hover:"hover:bg-gray-100"},values:{borderRadius:"0.5rem",fontSizes:{small:"0.875rem",medium:"1rem",large:"1.25rem"},spacing:{small:"0.5rem",medium:"1rem",large:"2rem"}}},dark:{mode:"dark",colors:{primary:"#3b82f6",secondary:"#0ea5e9",s_text:"text-blue-300",d_text:"text-slate-300",s_background:"from-slate-800/80 to-slate-700/80",sl_background:"bg-slate-900",c_background:"bg-slate-800/50",a_background:"from-slate-900 via-blue-900 to-slate-800",background:"bg-slate-800",text:"#f9fafb",accent:"#a78bfa",hover:"hover:bg-gray-700"},values:{borderRadius:"0.5rem",fontSizes:{small:"0.875rem",medium:"1rem",large:"1.25rem"},spacing:{small:"0.5rem",medium:"1rem",large:"2rem"}}}},n=(0,a.createContext)(void 0),o=e=>{let{children:t}=e,[r,o]=(0,a.useState)("light"),[c,i]=(0,a.useState)(!1),d=e=>{o(e),c&&(localStorage.setItem("theme",e),u(e))},u=e=>{let t=document.documentElement,r=s[e];if(!r||!r.colors||!r.values)return void console.warn("Theme '".concat(e,"' not found or incomplete"));Object.entries(r.colors).forEach(e=>{let[r,l]=e;"string"==typeof l&&l.startsWith("#")&&t.style.setProperty("--color-".concat(r),l)}),t.style.setProperty("--border-radius",r.values.borderRadius),Object.entries(r.values.fontSizes).forEach(e=>{let[r,l]=e;t.style.setProperty("--font-size-".concat(r),l)}),Object.entries(r.values.spacing).forEach(e=>{let[r,l]=e;t.style.setProperty("--spacing-".concat(r),l)}),t.setAttribute("data-theme",e)};if((0,a.useEffect)(()=>{let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,r=e||(t?"dark":"light");o(r),u(r),i(!0);let l=window.matchMedia("(prefers-color-scheme: dark)"),a=e=>{if(!localStorage.getItem("theme")){let t=e.matches?"dark":"light";o(t),u(t)}};return l.addEventListener("change",a),()=>l.removeEventListener("change",a)},[]),!c)return null;let m=s[r];return m?(0,l.jsx)(n.Provider,{value:{theme:m,setTheme:d,toggleTheme:()=>{d("light"===r?"dark":"light")}},children:(0,l.jsx)("div",{className:"".concat(r,"-theme"),children:t})}):(console.error("Invalid theme mode: ".concat(r)),null)},c=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},9681:(e,t,r)=>{Promise.resolve().then(r.bind(r,3966))}},e=>{var t=t=>e(e.s=t);e.O(0,[271,711,218,464,441,684,358],()=>t(9681)),_N_E=e.O()}]);